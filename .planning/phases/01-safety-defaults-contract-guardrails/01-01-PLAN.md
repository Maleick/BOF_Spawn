---
phase: 01-safety-defaults-contract-guardrails
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - BOF_spawn.cna
autonomous: true
requirements: [SAFE-01]
must_haves:
  truths:
    - Default profile remains RW->RX unless operator explicitly opts into RWX.
    - Callback is not the default execution mode.
    - Operator sees concise action-first default posture output before execution.
  artifacts:
    - BOF_spawn.cna
  key_links:
    - BOF_spawn.cna default variables feed ProcessConfig and both alias execution entry points.
---

<objective>
Align CNA defaults and baseline operator messaging to strict-safe posture.

Purpose: remove ambiguous or unsafe startup behavior from operator workflows.
Output: single strict-safe default profile consistently applied in dialog + alias paths.
</objective>

<execution_context>
@/Users/maleick/.codex/get-shit-done/workflows/execute-plan.md
@/Users/maleick/.codex/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/REQUIREMENTS.md
@.planning/STATE.md
@.planning/phases/01-safety-defaults-contract-guardrails/01-CONTEXT.md
@.planning/phases/01-safety-defaults-contract-guardrails/01-RESEARCH.md
@BOF_spawn.cna
</context>

<tasks>

<task type="auto">
  <name>Task 1: Normalize strict-safe defaults in CNA</name>
  <files>BOF_spawn.cna</files>
  <action>Set default variable values so RWX remains disabled by default and callback mode is not default-selected. Keep defaults session-persistent in script scope to match context constraints.</action>
  <verify><automated>rg -n '^\$use_rwx = "false";|^\$exec = "Hijack RIP Direct";' BOF_spawn.cna</automated></verify>
  <done>Fresh session starts with strict-safe defaults requiring explicit opt-in for riskier options.</done>
</task>

<task type="auto">
  <name>Task 2: Update dialog and apply-summary text for safety contract</name>
  <files>BOF_spawn.cna</files>
  <action>Revise dialog description and ApplyConfig summary strings so they explicitly communicate strict-safe baseline, RWX opt-in behavior, and concise action-first guidance.</action>
  <verify><automated>rg -n 'strict-safe|opt-in|Use RWX|Execution method|Configuration Update' BOF_spawn.cna</automated></verify>
  <done>Operator-facing config copy matches the locked default safety posture.</done>
</task>

<task type="auto">
  <name>Task 3: Ensure deterministic startup policy output in both aliases</name>
  <files>BOF_spawn.cna</files>
  <action>Keep policy printouts identical across `spawn_beacon` and `spawn_shellcode` with concise lines for Block DLL, CFG, RWX, and execution method value before BOF dispatch.</action>
  <verify><automated>rg -n 'spawn_beacon|spawn_shellcode|Block DLL:|Disable CFG:|Use RWX:|Execution:' BOF_spawn.cna</automated></verify>
  <done>Both alias paths emit the same low-noise safety posture snapshot.</done>
</task>

</tasks>

<verification>
- SAFE-01 is represented in frontmatter and covered by task outcomes.
- Default posture is strict-safe and callback-disabled.
- Output style remains concise and action-first.
</verification>

<success_criteria>
- [ ] SAFE-01 implemented completely.
- [ ] RWX stays manual opt-in by default.
- [ ] Callback is not default execution mode.
</success_criteria>

<output>
After completion, create .planning/phases/01-safety-defaults-contract-guardrails/01-01-SUMMARY.md.
</output>
