---
phase: 02-core-reliability-hardening
plan: 02
type: execute
wave: 2
depends_on: [01]
files_modified:
  - Src/Bof.c
autonomous: true
requirements: [RELI-02]
must_haves:
  truths:
    - Parent-process lookup uses exact case-insensitive executable-name matching only.
    - Substring and partial-name PPID matches are eliminated.
    - Invalid or unresolved PPID target input fails closed with actionable diagnostics.
  artifacts:
    - Src/Bof.c
  key_links:
    - PPID lookup normalization and comparison logic directly feeds SpawnAndRun parent-handle open path.
---

<objective>
Replace permissive PPID lookup with deterministic exact-match selection.

Purpose: satisfy RELI-02 by enforcing fail-closed parent-process resolution.
Output: exact executable-name matching contract with explicit failure handling.
</objective>

<execution_context>
@/Users/maleick/.codex/get-shit-done/workflows/execute-plan.md
@/Users/maleick/.codex/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/REQUIREMENTS.md
@.planning/STATE.md
@.planning/phases/02-core-reliability-hardening/02-CONTEXT.md
@.planning/phases/02-core-reliability-hardening/02-RESEARCH.md
@Src/Bof.c
</context>

<tasks>

<task type="auto">
  <name>Task 1: Implement exact executable-name compare helper for PPID lookup</name>
  <files>Src/Bof.c</files>
  <action>Refactor `GetProcessIdWithNameW` to normalize caller input to executable basename and compare with process snapshot names using exact case-insensitive equality (no substring logic). Keep behavior deterministic across repeated calls.</action>
  <verify><automated>rg -n 'GetProcessIdWithNameW|lstrcmpiW|basename|StrStrW' Src/Bof.c</automated></verify>
  <done>PPID lookup path enforces exact executable-name equality and no longer uses permissive matching.</done>
</task>

<task type="auto">
  <name>Task 2: Fail closed on missing or invalid PPID target</name>
  <files>Src/Bof.c</files>
  <action>Ensure unresolved parent process names return a clear operator-facing error and stop execution before any parent-handle fallback. Keep diagnostics concise and remediation-oriented.</action>
  <verify><automated>rg -n 'Failed to find parent process|STATUS_INVALID_PARAMETER_2|next step' Src/Bof.c</automated></verify>
  <done>Invalid PPID input paths stop deterministically with explicit failure semantics.</done>
</task>

<task type="auto">
  <name>Task 3: Update PPID contract comments to document exact-match behavior</name>
  <files>Src/Bof.c</files>
  <action>Revise function-level comments around parent selection to state exact case-insensitive executable matching and fail-closed semantics so future edits preserve RELI-02 behavior.</action>
  <verify><automated>rg -n 'exact case-insensitive executable-name matching|fail closed|PPID' Src/Bof.c</automated></verify>
  <done>Code comments match implemented RELI-02 behavior and reduce ambiguity.</done>
</task>

</tasks>

<verification>
- RELI-02 is represented in frontmatter and covered by task outcomes.
- PPID matching behavior is deterministic and exact.
- Missing match cases fail closed with no silent fallback.
</verification>

<success_criteria>
- [ ] RELI-02 implemented completely.
- [ ] Substring PPID matching removed.
- [ ] No-match parent target fails closed with clear diagnostics.
</success_criteria>

<output>
After completion, create .planning/phases/02-core-reliability-hardening/02-02-SUMMARY.md.
</output>
